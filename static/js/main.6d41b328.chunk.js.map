{"version":3,"sources":["file/FileUpload.js","layout/MainHeading.js","layout/TextInput.js","layout/Label.js","tableau/Connection.js","layout/TableData.js","tableau/Column.js","layout/Details.js","layout/TableHeader.js","tableau/Datasource.js","tableau/Worksheet.js","tableau/Workbook.js","tableau/WorkbookView.js","layout/TopNav.js","App.js","reportWebVitals.js","index.js"],"names":["FileUpload","props","handleChange","event","file","target","files","setState","addEvent","state","undefined","bind","className","htmlFor","type","name","onChange","React","Component","MainHeading","children","TextInput","id","defaultValue","Label","Connection","connectionXML","dbName","server","username","authentication","schema","service","port","this","_setUpdate","prevProps","connection","getAttribute","connectionClass","action","TableData","Column","columnXML","caption","datatype","role","calculation","description","usedIn","_prepareCalculation","_addUsedIn","column","worksheetDatasources","formula","calculationElement","getElementsByTagName","worksheet","datasourceInfo","datasourceDeps","columns","includes","push","join","Details","opened","onClick","handleClick","icon","title","TableHeader","Datasource","datasourceXML","version","connections","_prepareConnections","_prepareColumns","_filterWorksheets","datasource","connectionsElements","index","length","columnsElements","relatedWorksheets","thisDatasource","filter","element","worksheetName","datasourceName","map","connectionIndex","columnIndex","Worksheet","worksheetXML","datasourceDependencies","_DatasourceDepsToParent","_prepareDatasourceDependencies","workbook","addDatasourceDeps","dependencies","dependency","columnName","Workbook","fileName","workbookXML","dashboards","datasources","worksheets","worksheetsDatasources","_prepareDashboards","_prepareDatasources","_prepareWorksheets","_addWorksheetDeps","xmlDoc","dashboardElements","dashboardName","datasourceElements","worksheetElements","worksheetDetails","prevState","datasourcesIndex","datasourceDepIndex","datasourceDep","addUsedIn","xmlStr","XMLSerializer","serializeToString","_workbookXML","downloadAnchor","document","createElement","setAttribute","encodeURIComponent","_fileName","style","display","body","appendChild","click","removeChild","datasourceIndex","worksheetIndex","WorkbookView","add","loaded","fileObject","parser","DOMParser","split","slice","JSZip","loadAsync","then","zip","twbName","Object","keys","find","async","content","errorMessage","parseFromString","reader","FileReader","onload","result","readAsText","loadedEvent","TopNav","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.6d41b328.chunk.js","sourcesContent":["import React from \"react\";\r\n\r\nexport default class FileUpload extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = { file: undefined };\r\n    this.handleChange = this.handleChange.bind(this);\r\n  }\r\n\r\n  handleChange = (event) => {\r\n    let file = event.target.files[0];\r\n    if (file) {\r\n      this.setState({ file: file }, () => {\r\n        if (this.props.addEvent) {\r\n          this.props.addEvent(this.state.file);\r\n        }\r\n      });\r\n    }\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"mb-8\">\r\n        <label className=\"text-sm font-medium text-gray-900 block\" htmlFor=\"twb\"></label>\r\n        <input\r\n          className=\"block cursor-pointer bg-gray-50 border border-gray-300 text-gray-900 focus:outline-none focus:border-transparent text-sm\"\r\n          type=\"file\"\r\n          name=\"twb\"\r\n          onChange={(event) => this.handleChange(event)}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","export default function MainHeading(props) {\r\n  return (\r\n    <div className=\"text-center my-8 text-4xl\">\r\n      <h1>{props.children}</h1>\r\n    </div>\r\n  );\r\n}\r\n","export default function TextInput(props) {\r\n  return (\r\n    <input\r\n      className=\"border appearance-none shadow-sm rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\r\n      type=\"text\"\r\n      name={props.name}\r\n      id={props.id}\r\n      defaultValue={props.defaultValue}\r\n    />\r\n  );\r\n}\r\n","export default function Label(props) {\r\n  return (\r\n    <label className=\"block text-gray-700 text-sm font-bold my-2\" htmlFor={props.htmlFor}>\r\n      {props.children}\r\n    </label>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport TextInput from \"../layout/TextInput.js\";\r\nimport Label from \"../layout/Label.js\";\r\n\r\nexport default class Connection extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      connectionXML: null,\r\n      dbName: null,\r\n      server: null,\r\n      username: null,\r\n      authentication: null,\r\n      className: null,\r\n      schema: null,\r\n      service: null,\r\n      port: null,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this._setUpdate();\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (prevProps.connection !== this.props.connection) {\r\n      this._setUpdate();\r\n    }\r\n  }\r\n\r\n  _setUpdate() {\r\n    this.setState((state, props) => ({\r\n      connectionXML: this.props.connection,\r\n      dbName: this.props.connection.getAttribute(\"dbname\"),\r\n      server: this.props.connection.getAttribute(\"server\"),\r\n      username: this.props.connection.getAttribute(\"username\"),\r\n      authentication: this.props.connection.getAttribute(\"authentication\"),\r\n      className: this.props.connection.getAttribute(\"class\"),\r\n      schema: this.props.connection.getAttribute(\"schema\"),\r\n      service: this.props.connection.getAttribute(\"service\"),\r\n      port: this.props.connection.getAttribute(\"port\"),\r\n    }));\r\n  }\r\n\r\n  render() {\r\n    const connectionClass = this.state.className;\r\n    const dbName = this.state.dbName;\r\n\r\n    if (connectionClass && dbName) {\r\n      return (\r\n        <section>\r\n          <div className=\"bg-white border rounded px-8 pt-6 pb-8 mb-4\">\r\n            <h4 className=\"my-2 text-gray-400 font-bold\">Connection</h4>\r\n            <form action=\"\">\r\n              <Label htmlFor=\"dbName\">DB Name: </Label>\r\n              <TextInput type=\"text\" name=\"dbName\" id=\"\" defaultValue={this.state.dbName} />\r\n            </form>\r\n          </div>\r\n        </section>\r\n      );\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n}\r\n","export default function TableData(props) {\r\n  return <td className=\"px-6 py-4 text-sm text-gray-500 border border-gray-300\">{props.children}</td>;\r\n}\r\n","import React from \"react\";\r\nimport TableData from \"../layout/TableData.js\";\r\n\r\nexport default class Column extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      columnXML: null,\r\n      name: null,\r\n      caption: null,\r\n      datatype: null,\r\n      role: null,\r\n      type: null,\r\n      calculation: null,\r\n      description: null,\r\n      usedIn: null,\r\n    };\r\n    this._setUpdate = this._setUpdate.bind(this);\r\n    this._prepareCalculation = this._prepareCalculation.bind(this);\r\n    this._addUsedIn = this._addUsedIn.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    this._setUpdate();\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    let condition = prevProps.column !== this.props.column || prevProps.worksheetDatasources !== this.props.worksheetDatasources;\r\n    if (condition) {\r\n      this._setUpdate();\r\n    }\r\n  }\r\n\r\n  _setUpdate() {\r\n    this.setState((state, props) => ({\r\n      columnXML: this.props.column,\r\n      name: this.props.column.getAttribute(\"name\"),\r\n      caption: this.props.column.getAttribute(\"caption\"),\r\n      datatype: this.props.column.getAttribute(\"datatype\"),\r\n      role: this.props.column.getAttribute(\"role\"),\r\n      type: this.props.column.getAttribute(\"type\"),\r\n      calculation: this._prepareCalculation(this.props.column),\r\n      description: this.props.column.getAttribute(\"description\"),\r\n      usedIn: this._addUsedIn(),\r\n    }));\r\n  }\r\n\r\n  _prepareCalculation(columnXML) {\r\n    let formula = null;\r\n    let calculationElement = columnXML.getElementsByTagName(\"calculation\")[0];\r\n    if (calculationElement) {\r\n      formula = calculationElement.getAttribute(\"formula\");\r\n    }\r\n    return formula;\r\n  }\r\n\r\n  _addUsedIn() {\r\n    let usedIn = [];\r\n    const worksheetDatasources = this.props.worksheetDatasources;\r\n    for (let worksheet of worksheetDatasources) {\r\n      const datasourceInfo = worksheet.datasourceDeps;\r\n      if (datasourceInfo) {\r\n        let used = datasourceInfo.columns.includes(`[${this.state.name}]`);\r\n        if (used) {\r\n          usedIn.push(worksheet.name);\r\n        }\r\n      }\r\n    }\r\n    return usedIn;\r\n  }\r\n\r\n  render() {\r\n    const name = this.state.name;\r\n    if (name) {\r\n      return (\r\n        <tr>\r\n          <TableData>{this.state.name}</TableData>\r\n          <TableData>{this.state.caption}</TableData>\r\n          <TableData>{this.state.datatype}</TableData>\r\n          <TableData>{this.state.role}</TableData>\r\n          <TableData>{this.state.type}</TableData>\r\n          <TableData>{this.state.calculation}</TableData>\r\n          <TableData>{this.state.description}</TableData>\r\n          <TableData>{this.state.usedIn.join(\", \")}</TableData>\r\n        </tr>\r\n      );\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n}\r\n","import React from \"react\";\r\n\r\nexport default class Details extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = { opened: false };\r\n  }\r\n\r\n  handleClick(event) {\r\n    if (event.target) {\r\n      this.setState((state, props) => ({ opened: !state.opened }));\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const opened = this.state.opened;\r\n    return (\r\n      <details className=\"bg-white mb-3 p-3 rounded border\" onClick={(event) => this.handleClick(event)}>\r\n        <summary>\r\n          <span className=\"mx-2\">{this.props.icon}</span>\r\n          <h3>{this.props.title}</h3>\r\n          <span className={`icon ${opened ? \"transform rotate-180\" : \"\"}`}>ðŸ‘‡</span>\r\n        </summary>\r\n        <div className=\"mt-4\">{this.props.children}</div>\r\n      </details>\r\n    );\r\n  }\r\n}\r\n","export default function TableHeader(props) {\r\n  return <td className=\"px-6 py-2 text-xs text-gray-500 border border-gray-300\">{props.children}</td>;\r\n}\r\n","import Connection from \"./Connection.js\";\r\nimport Column from \"./Column.js\";\r\nimport Details from \"../layout/Details.js\";\r\nimport TextInput from \"../layout/TextInput.js\";\r\nimport Label from \"../layout/Label.js\";\r\nimport TableHeader from \"../layout/TableHeader.js\";\r\n\r\nimport React from \"react\";\r\n\r\nexport default class Datasource extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      datasourceXML: null,\r\n      name: null,\r\n      version: null,\r\n      caption: null,\r\n      connections: null,\r\n      columns: null,\r\n    };\r\n    this._setUpdate = this._setUpdate.bind(this);\r\n    this._prepareConnections = this._prepareConnections.bind(this);\r\n    this._prepareColumns = this._prepareColumns.bind(this);\r\n    this._filterWorksheets = this._filterWorksheets.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    this._setUpdate();\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (prevProps.datasource !== this.props.datasource) {\r\n      this._setUpdate();\r\n    }\r\n  }\r\n\r\n  _setUpdate() {\r\n    this.setState((state, props) => ({\r\n      datasourceXML: this.props.datasource,\r\n      name: this.props.datasource.getAttribute(\"name\"),\r\n      version: this.props.datasource.getAttribute(\"version\"),\r\n      caption: this.props.datasource.getAttribute(\"caption\"),\r\n      connections: this._prepareConnections(this.props.datasource),\r\n      columns: this._prepareColumns(this.props.datasource),\r\n    }));\r\n  }\r\n\r\n  _prepareConnections(datasourceXML) {\r\n    let connections = [];\r\n    let connectionsElements = datasourceXML.getElementsByTagName(\"connection\");\r\n    for (let index = 0; index < connectionsElements.length; index++) {\r\n      connections.push(connectionsElements[index]);\r\n    }\r\n    return connections;\r\n  }\r\n\r\n  _prepareColumns(datasourceXML) {\r\n    let columns = [];\r\n    let columnsElements = datasourceXML.getElementsByTagName(\"column\");\r\n    for (let index = 0; index < columnsElements.length; index++) {\r\n      columns.push(columnsElements[index]);\r\n    }\r\n    return columns;\r\n  }\r\n\r\n  _filterWorksheets() {\r\n    const worksheetDatasources = this.props.worksheetDatasources;\r\n    let relatedWorksheets = [];\r\n    for (let worksheet of worksheetDatasources) {\r\n      let thisDatasource = worksheet.datasourceDeps.filter((element) => {\r\n        return element.name === this.state.name;\r\n      });\r\n      relatedWorksheets.push({ name: worksheet.worksheetName, datasourceDeps: thisDatasource[0] });\r\n    }\r\n    return relatedWorksheets;\r\n  }\r\n\r\n  render() {\r\n    const datasourceName = this.state.name;\r\n    const connections = this.state.connections;\r\n    const caption = this.state.caption;\r\n    const columns = this.state.columns;\r\n\r\n    const worksheetDatasources = this._filterWorksheets();\r\n\r\n    if (datasourceName) {\r\n      return (\r\n        <Details title={`${caption} - ${datasourceName}`}>\r\n          <div className=\"flex flex-row\">\r\n            <div className=\"flex flex-col shadow-md bg-indigo-500 rounded text-center text-white m-2 p-2\">\r\n              {connections.length} <span>Connections</span>\r\n            </div>\r\n            <div className=\"flex flex-col shadow-md bg-indigo-500 rounded text-center text-white m-2 p-2\">\r\n              {columns.length} <span>Columns</span>\r\n            </div>\r\n          </div>\r\n          <form className=\"bg-white rounded px-8 pt-6 pb-8 mb-4\">\r\n            <div>\r\n              <div>\r\n                <Label htmlFor=\"name\">Name</Label>\r\n                <TextInput name=\"name\" id=\"\" defaultValue={this.state.name} />\r\n              </div>\r\n              <div>\r\n                <Label htmlFor=\"version\">Version</Label>\r\n                <TextInput name=\"version\" id=\"\" defaultValue={this.state.version} />\r\n              </div>\r\n              <div>\r\n                <Label htmlFor=\"caption\">Caption</Label>\r\n                <TextInput name=\"caption\" id=\"\" defaultValue={this.state.caption} />\r\n              </div>\r\n            </div>\r\n          </form>\r\n          {connections.map((connection, connectionIndex) => {\r\n            return <Connection key={connectionIndex} connection={connection} />;\r\n          })}\r\n          <div className=\"bg-white border rounded px-8 pt-6 pb-8 mb-4\">\r\n            <h4 className=\"my-2 text-gray-400 font-bold\">Columns</h4>\r\n            <div className=\"table-wrapper overflow-y-auto\">\r\n              <table className=\"table-fixed border-separate border\">\r\n                <thead className=\"bg-gray-50 sticky top-0\">\r\n                  <tr>\r\n                    <TableHeader>Name</TableHeader>\r\n                    <TableHeader>Caption</TableHeader>\r\n                    <TableHeader>Datatype</TableHeader>\r\n                    <TableHeader>Role</TableHeader>\r\n                    <TableHeader>Type</TableHeader>\r\n                    <TableHeader>Calculation</TableHeader>\r\n                    <TableHeader>Description</TableHeader>\r\n                    <TableHeader>Used In</TableHeader>\r\n                  </tr>\r\n                </thead>\r\n                <tbody className=\"bg-white\">\r\n                  {columns.map((column, columnIndex) => {\r\n                    return <Column key={columnIndex} column={column} worksheetDatasources={worksheetDatasources} />;\r\n                  })}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n        </Details>\r\n      );\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n}\r\n","import React from \"react\";\r\n\r\nexport default class Worksheet extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      worksheetXML: null,\r\n      name: null,\r\n      datasourceDependencies: null,\r\n    };\r\n    this._setUpdate = this._setUpdate.bind(this);\r\n    this._DatasourceDepsToParent = this._DatasourceDepsToParent.bind(this);\r\n    this._prepareDatasourceDependencies = this._prepareDatasourceDependencies.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    this._setUpdate();\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (prevProps.workbook !== this.props.workbook) {\r\n      this._setUpdate();\r\n    }\r\n  }\r\n\r\n  _setUpdate() {\r\n    this.setState(\r\n      (state, props) => ({\r\n        datasourceXML: this.props.worksheet,\r\n        name: this.props.worksheet.getAttribute(\"name\"),\r\n        datasourceDependencies: this._prepareDatasourceDependencies(this.props.worksheet),\r\n      }),\r\n      () => {\r\n        this._DatasourceDepsToParent();\r\n      }\r\n    );\r\n  }\r\n\r\n  _DatasourceDepsToParent() {\r\n    if (this.props.addDatasourceDeps) {\r\n      this.props.addDatasourceDeps(this.state.name, this.state.datasourceDependencies);\r\n    }\r\n  }\r\n\r\n  _prepareDatasourceDependencies(worksheetXML) {\r\n    let datasourceDependencies = [];\r\n    let dependencies = worksheetXML.getElementsByTagName(\"datasource-dependencies\");\r\n    for (let index = 0; index < dependencies.length; index++) {\r\n      let dependency = dependencies[index];\r\n      let datasource = { name: \"\", columns: [] };\r\n      datasource.name = dependency.getAttribute(\"datasource\");\r\n      let columns = dependency.getElementsByTagName(\"column\");\r\n      for (let index = 0; index < columns.length; index++) {\r\n        let column = columns[index];\r\n        let columnName = column.getAttribute(\"name\");\r\n        datasource.columns.push(columnName);\r\n      }\r\n      datasourceDependencies.push(datasource);\r\n    }\r\n    return datasourceDependencies;\r\n  }\r\n\r\n  render() {\r\n    const worksheetName = this.state.name;\r\n    if (worksheetName) {\r\n      return <li>{this.state.name}</li>;\r\n    } else {\r\n      return \"\";\r\n    }\r\n  }\r\n}\r\n","import Datasource from \"./Datasource.js\";\r\nimport Worksheet from \"./Worksheet.js\";\r\nimport Details from \"../layout/Details.js\";\r\nimport { Database, FileText } from \"react-feather\";\r\n\r\nimport React from \"react\";\r\n\r\nexport default class Workbook extends React.Component {\r\n  /**\r\n  Class for writing tableau workbook files\r\n   */\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      fileName: null,\r\n      workbookXML: null,\r\n      dashboards: null,\r\n      datasources: null,\r\n      worksheets: null,\r\n      worksheetsDatasources: [],\r\n    };\r\n    this._setUpdate = this._setUpdate.bind(this);\r\n    this._prepareDashboards = this._prepareDashboards.bind(this);\r\n    this._prepareDatasources = this._prepareDatasources.bind(this);\r\n    this._prepareWorksheets = this._prepareWorksheets.bind(this);\r\n    this._addWorksheetDeps = this._addWorksheetDeps.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    this._setUpdate();\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (prevProps.workbook !== this.props.workbook) {\r\n      this._setUpdate();\r\n    }\r\n  }\r\n\r\n  _setUpdate() {\r\n    this.setState((state, props) => ({\r\n      fileName: this.props.workbook.file.name,\r\n      workbookXML: this.props.workbook.xmlDoc,\r\n      dashboards: this._prepareDashboards(this.props.workbook.xmlDoc),\r\n      datasources: this._prepareDatasources(this.props.workbook.xmlDoc),\r\n      worksheets: this._prepareWorksheets(this.props.workbook.xmlDoc),\r\n    }));\r\n  }\r\n\r\n  _prepareDashboards(workbookXML) {\r\n    let dashboards = [];\r\n\r\n    let dashboardElements = workbookXML.getElementsByTagName(\"dashboards\")[0].children;\r\n    if (!dashboardElements) return [];\r\n\r\n    for (let dashboard of dashboardElements) {\r\n      let dashboardName = dashboard.getAttribute(\"name\");\r\n      dashboards.push(dashboardName);\r\n    }\r\n    return dashboards;\r\n  }\r\n\r\n  _prepareDatasources(workbookXML) {\r\n    let datasources = [];\r\n\r\n    let datasourceElements = workbookXML.getElementsByTagName(\"datasources\")[0].children;\r\n    if (!datasourceElements) return [];\r\n\r\n    for (let datasourceXML of datasourceElements) {\r\n      datasources.push(datasourceXML);\r\n    }\r\n    return datasources;\r\n  }\r\n\r\n  _prepareWorksheets(workbookXML) {\r\n    let worksheets = [];\r\n\r\n    let worksheetElements = workbookXML.getElementsByTagName(\"worksheets\")[0].children;\r\n    if (!worksheetElements) return [];\r\n\r\n    for (let worksheetXML of worksheetElements) {\r\n      worksheets.push(worksheetXML);\r\n    }\r\n    return worksheets;\r\n  }\r\n\r\n  _addWorksheetDeps(worksheetName, datasourceDeps) {\r\n    let worksheetDetails = { worksheetName: worksheetName, datasourceDeps: datasourceDeps };\r\n    this.setState((prevState) => ({\r\n      worksheetsDatasources: [...prevState.worksheetsDatasources, worksheetDetails],\r\n    }));\r\n  }\r\n\r\n  _checkFieldsUsage(worksheets, datasourcesIndex) {\r\n    for (let worksheet of worksheets) {\r\n      for (let datasourceDepIndex in worksheet.datasourceDependencies) {\r\n        let datasourceDep = worksheet.datasourceDependencies[datasourceDepIndex];\r\n        let datasource = datasourcesIndex[datasourceDep.name];\r\n        for (let columnIndex in datasource.columns) {\r\n          let column = datasource.columns[columnIndex];\r\n          if (datasourceDep.columns.includes(column.name)) {\r\n            column.addUsedIn(worksheet.name);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  save() {\r\n    const serializer = new XMLSerializer();\r\n    const xmlStr = serializer.serializeToString(this._workbookXML);\r\n    let downloadAnchor = document.createElement(\"a\");\r\n\r\n    downloadAnchor.setAttribute(\"href\", \"data:text/twb;charset=utf-8,\" + encodeURIComponent(xmlStr));\r\n    downloadAnchor.setAttribute(\"download\", this._fileName);\r\n\r\n    downloadAnchor.style.display = \"none\";\r\n    document.body.appendChild(downloadAnchor);\r\n\r\n    downloadAnchor.click();\r\n\r\n    document.body.removeChild(downloadAnchor);\r\n  }\r\n\r\n  render() {\r\n    const datasources = this.state.datasources;\r\n    const worksheets = this.state.worksheets;\r\n    const dashboards = this.state.dashboards;\r\n    const worksheetsDatasources = this.state.worksheetsDatasources;\r\n\r\n    if (datasources && worksheets) {\r\n      return (\r\n        <section>\r\n          <div className=\"mb-4 border-b-2\">\r\n            <h2 className=\"text-2xl mb-4\">\r\n              <span>{this.state.fileName}</span>\r\n            </h2>\r\n            <div className=\"flex flex-row\">\r\n              <div className=\"flex flex-col shadow-md bg-indigo-500 rounded text-center text-white m-2 p-2\">\r\n                {worksheets.length} <span>Worksheets</span>\r\n              </div>\r\n              <div className=\"flex flex-col shadow-md bg-indigo-500 rounded text-center text-white m-2 p-2\">\r\n                {datasources.length} <span>Datasources</span>\r\n              </div>\r\n              <div className=\"flex flex-col shadow-md bg-indigo-500 rounded text-center text-white m-2 p-2\">\r\n                {dashboards.length} <span>Dashboards</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <Details title=\"Datasources\" icon={<Database />}>\r\n            {datasources.map((datasource, datasourceIndex) => {\r\n              return <Datasource key={datasourceIndex} datasource={datasource} worksheetDatasources={worksheetsDatasources} />;\r\n            })}\r\n          </Details>\r\n          <Details title=\"Worksheets\" icon={<FileText />}>\r\n            <ul className=\"list-disc list-inside\">\r\n              {worksheets.map((worksheet, worksheetIndex) => {\r\n                return <Worksheet key={worksheetIndex} worksheet={worksheet} addDatasourceDeps={this._addWorksheetDeps} />;\r\n              })}\r\n            </ul>\r\n          </Details>\r\n        </section>\r\n      );\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport JSZip from \"jszip\";\r\n\r\nimport FileUpload from \"../file/FileUpload.js\";\r\nimport MainHeading from \"../layout/MainHeading.js\";\r\n\r\nimport Workbook from \"./Workbook.js\";\r\n\r\nexport default class WorkbookView extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = { file: null, xmlDoc: null };\r\n    this.add = this.add.bind(this);\r\n    this.loaded = this.loaded.bind(this);\r\n  }\r\n\r\n  add(fileObject) {\r\n    this.setState({ file: fileObject }, () => this.loaded());\r\n  }\r\n\r\n  loaded() {\r\n    const parser = new DOMParser();\r\n    const file = this.state.file;\r\n\r\n    let type = file.name.split(\".\").slice(-1)[0];\r\n    if (type === \"twbx\") {\r\n      const zip = new JSZip();\r\n      zip.loadAsync(file).then((zip) => {\r\n        const twbName = Object.keys(zip.files).find((file) => file.includes(\".twb\"));\r\n        const twb = zip.files[twbName];\r\n        twb.async(\"string\").then((content) => {\r\n          if (!content) return (this.errorMessage = \"No twb file found\");\r\n          let xmlDoc = parser.parseFromString(content, \"text/xml\");\r\n          this.setState({ xmlDoc: xmlDoc });\r\n        });\r\n      });\r\n    } else if (type === \"twb\") {\r\n      const reader = new FileReader();\r\n      reader.onload = (event) => {\r\n        let xmlDoc = parser.parseFromString(event.target.result, \"text/xml\");\r\n        this.setState({ xmlDoc: xmlDoc });\r\n      };\r\n      reader.readAsText(file, \"UTF-8\");\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const file = this.state.file;\r\n    const xmlDoc = this.state.xmlDoc;\r\n    if (file && xmlDoc) {\r\n      return (\r\n        <div className=\"container mx-auto px-4\">\r\n          <MainHeading>Workbook</MainHeading>\r\n          <FileUpload addEvent={this.add} loadedEvent={this.loaded} />\r\n          <Workbook workbook={this.state} />\r\n        </div>\r\n      );\r\n    } else {\r\n      return (\r\n        <div className=\"container mx-auto px-4\">\r\n          <MainHeading>Workbook</MainHeading>\r\n          <FileUpload addEvent={this.add} />\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n","export default function TopNav(props) {\r\n  return (\r\n    <nav className=\"bg-gray-100 p-6\">\r\n      <div>\r\n        <span className=\"text-gray-700 font-bold\">DataUtils</span>\r\n      </div>\r\n    </nav>\r\n  );\r\n}\r\n","import WorkbookView from \"./tableau/WorkbookView.js\";\nimport TopNav from \"./layout/TopNav.js\";\n\nimport React from \"react\";\nimport \"./App.css\";\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <main>\n        <TopNav />\n        <WorkbookView />\n      </main>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}